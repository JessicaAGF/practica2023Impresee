{
    "CLICK PRODUCT" : "INSERT INTO \"%s %s\" WITH source AS (SELECT * FROM TABLE( EXTERN('{\"type\":\"local\",\"baseDir\":\"%s\",\"filter\":\"%s\"}',  '{\"type\":\"json\",\"flattenSpec\":{\"fields\":[{\"name\":\"req.ci\",\"type\":\"path\",\"expr\":\"$.req.ci\"},{\"name\":\"req.co\",\"type\":\"path\",\"expr\":\"$.req.co\"},{\"name\":\"req.cse\",\"type\":\"path\",\"expr\":\"$.req.cse\"},{\"name\":\"req.ctr\",\"type\":\"path\",\"expr\":\"$.req.ctr\"},{\"name\":\"req.el\",\"type\":\"path\",\"expr\":\"$.req.el\"},{\"name\":\"req.il\",\"type\":\"path\",\"expr\":\"$.req.il\"},{\"name\":\"req.ilt\",\"type\":\"path\",\"expr\":\"$.req.ilt\"},{\"name\":\"req.im\",\"type\":\"path\",\"expr\":\"$.req.im\"},{\"name\":\"req.ip\",\"type\":\"path\",\"expr\":\"$.req.ip\"},{\"name\":\"req.ori\",\"type\":\"path\",\"expr\":\"$.req.ori\"},{\"name\":\"req.prx\",\"type\":\"path\",\"expr\":\"$.req.prx\"},{\"name\":\"req.ref\",\"type\":\"path\",\"expr\":\"$.req.ref\"},{\"name\":\"req.rl\",\"type\":\"path\",\"expr\":\"$.req.rl\"},{\"name\":\"req.rm\",\"type\":\"path\",\"expr\":\"$.req.rm\"},{\"name\":\"req.tm\",\"type\":\"path\",\"expr\":\"$.req.tm\"},{\"name\":\"req.ua\",\"type\":\"path\",\"expr\":\"$.req.ua\"},{\"name\":\"req.url\",\"type\":\"path\",\"expr\":\"$.req.url\"}]}}',  '[{\"name\":\"req.ci\",\"type\":\"string\"},{\"name\":\"req.co\",\"type\":\"string\"},{\"name\":\"req.cse\",\"type\":\"string\"},{\"name\":\"req.ctr\",\"type\":\"string\"},{\"name\":\"req.el\",\"type\":\"string\"},{\"name\":\"req.il\",\"type\":\"string\"},{\"name\":\"req.ilt\",\"type\":\"string\"},{\"name\":\"req.im\",\"type\":\"string\"},{\"name\":\"req.ip\",\"type\":\"string\"},{\"name\":\"req.ori\",\"type\":\"string\"},{\"name\":\"req.prx\",\"type\":\"string\"},{\"name\":\"req.ref\",\"type\":\"string\"},{\"name\":\"req.rl\",\"type\":\"string\"},{\"name\":\"req.rm\",\"type\":\"string\"},{\"name\":\"req.tm\",\"type\":\"string\"},{\"name\":\"req.ua\",\"type\":\"string\"},{\"name\":\"req.url\",\"type\":\"string\"},{\"name\":\"app\",\"type\":\"long\"},{\"name\":\"ignore\",\"type\":\"long\"},{\"name\":\"os\",\"type\":\"string\"},{\"name\":\"vid\",\"type\":\"string\"},{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"ua\",\"type\":\"string\"},{\"name\":\"cid\",\"type\":\"string\"},{\"name\":\"cna\",\"type\":\"string\"},{\"name\":\"day\",\"type\":\"long\"},{\"name\":\"time\",\"type\":\"long\"},{\"name\":\"dow\",\"type\":\"string\"},{\"name\":\"geoip\",\"type\":\"string\"},{\"name\":\"agent\",\"type\":\"string\"},{\"name\":\"url\",\"type\":\"string\"},{\"name\":\"uuid\",\"type\":\"string\"},{\"name\":\"search\",\"type\":\"string\"},{\"name\":\"rank\",\"type\":\"long\"},{\"name\":\"type\",\"type\":\"string\"},{\"name\":\"cfgrule\",\"type\":\"string\"},{\"name\":\"banner\",\"type\":\"long\"},{\"name\":\"prior\",\"type\":\"long\"},{\"name\":\"promo\",\"type\":\"long\"},{\"name\":\"pi\",\"type\":\"string\"},{\"name\":\"pp\",\"type\":\"long\"},{\"name\":\"ppf\",\"type\":\"long\"},{\"name\":\"pd\",\"type\":\"long\"},{\"name\":\"variant\",\"type\":\"string\"}]' ) )) SELECT COALESCE(CASE WHEN \"day\"> 0 THEN TIME_PARSE(CONCAT(\"day\", ' ',\"time\"), 'yyyyMMdd HHmmssSSS')  ELSE TIME_PARSE(CONCAT(\"day\", ' ',\"time\"), 'yyyyMMdd HHmmssSSS') END, TIME_PARSE(CONCAT(\"day\", ''), 'yyyyMMdd' )) AS __time,    \"req.ci\",         \"req.co\",         \"req.cse\",         \"req.ctr\",         \"req.el\",         \"req.il\",         \"req.ilt\",         \"req.im\",         \"req.ip\",         \"req.ori\",         \"req.prx\",         \"req.ref\",         \"req.rl\",         \"req.rm\",         \"req.tm\",         \"req.ua\",         \"req.url\",         \"app\",         \"ignore\",         \"os\",         \"vid\",         \"ip\",         \"ua\",         \"cid\",         \"cna\",         \"day\",         \"time\",         \"dow\",         \"geoip\",         \"agent\",         \"url\",         \"uuid\",         \"search\",         \"rank\",         \"type\",         \"cfgrule\",         \"banner\",         \"prior\",         \"promo\",         \"pi\",         \"pp\",         \"ppf\",         \"pd\",         \"variant\"       FROM source       PARTITIONED BY DAY",
    "EVENT": "INSERT INTO \"%s %s\" WITH source AS (SELECT * FROM TABLE(  EXTERN(    '{\"type\":\"local\",\"baseDir\":\"%s\",\"filter\":\"%s\"}',    '{\"type\":\"json\",\"flattenSpec\":{\"fields\":[{\"name\":\"req.ci\",\"type\":\"path\",\"expr\":\"$.req.ci\"},{\"name\":\"req.co\",\"type\":\"path\",\"expr\":\"$.req.co\"},{\"name\":\"req.cse\",\"type\":\"path\",\"expr\":\"$.req.cse\"},{\"name\":\"req.ctr\",\"type\":\"path\",\"expr\":\"$.req.ctr\"},{\"name\":\"req.el\",\"type\":\"path\",\"expr\":\"$.req.el\"},{\"name\":\"req.il\",\"type\":\"path\",\"expr\":\"$.req.il\"},{\"name\":\"req.ilt\",\"type\":\"path\",\"expr\":\"$.req.ilt\"},{\"name\":\"req.im\",\"type\":\"path\",\"expr\":\"$.req.im\"},{\"name\":\"req.ip\",\"type\":\"path\",\"expr\":\"$.req.ip\"},{\"name\":\"req.ori\",\"type\":\"path\",\"expr\":\"$.req.ori\"},{\"name\":\"req.prx\",\"type\":\"path\",\"expr\":\"$.req.prx\"},{\"name\":\"req.ref\",\"type\":\"path\",\"expr\":\"$.req.ref\"},{\"name\":\"req.rl\",\"type\":\"path\",\"expr\":\"$.req.rl\"},{\"name\":\"req.rm\",\"type\":\"path\",\"expr\":\"$.req.rm\"},{\"name\":\"req.tm\",\"type\":\"path\",\"expr\":\"$.req.tm\"},{\"name\":\"req.ua\",\"type\":\"path\",\"expr\":\"$.req.ua\"},{\"name\":\"req.url\",\"type\":\"path\",\"expr\":\"$.req.url\"}]}}',    '[{\"name\":\"req.ci\",\"type\":\"string\"},{\"name\":\"req.co\",\"type\":\"string\"},{\"name\":\"req.cse\",\"type\":\"string\"},{\"name\":\"req.ctr\",\"type\":\"string\"},{\"name\":\"req.el\",\"type\":\"string\"},{\"name\":\"req.il\",\"type\":\"string\"},{\"name\":\"req.ilt\",\"type\":\"string\"},{\"name\":\"req.im\",\"type\":\"string\"},{\"name\":\"req.ip\",\"type\":\"string\"},{\"name\":\"req.ori\",\"type\":\"string\"},{\"name\":\"req.prx\",\"type\":\"string\"},{\"name\":\"req.ref\",\"type\":\"string\"},{\"name\":\"req.rl\",\"type\":\"string\"},{\"name\":\"req.rm\",\"type\":\"string\"},{\"name\":\"req.tm\",\"type\":\"string\"},{\"name\":\"req.ua\",\"type\":\"string\"},{\"name\":\"req.url\",\"type\":\"string\"},{\"name\":\"app\",\"type\":\"long\"},{\"name\":\"ignore\",\"type\":\"long\"},{\"name\":\"os\",\"type\":\"string\"},{\"name\":\"vid\",\"type\":\"string\"},{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"ua\",\"type\":\"string\"},{\"name\":\"cid\",\"type\":\"string\"},{\"name\":\"cna\",\"type\":\"string\"},{\"name\":\"day\",\"type\":\"long\"},{\"name\":\"time\",\"type\":\"long\"},{\"name\":\"dow\",\"type\":\"string\"},{\"name\":\"geoip\",\"type\":\"string\"},{\"name\":\"agent\",\"type\":\"string\"},{\"name\":\"code\",\"type\":\"string\"},{\"name\":\"source\",\"type\":\"string\"},{\"name\":\"dup\",\"type\":\"long\"},{\"name\":\"prod\",\"type\":\"COMPLEX<json>\"},{\"name\":\"p\",\"type\":\"COMPLEX<json>\"}]'  ))) SELECT COALESCE(CASE WHEN \"day\"> 0 THEN TIME_PARSE(CONCAT(\"day\", ' ',\"time\"), 'yyyyMMdd HHmmssSSS')  ELSE TIME_PARSE(CONCAT(\"day\", ' ',\"time\"), 'yyyyMMdd HHmmssSSS') END, TIME_PARSE(CONCAT(\"day\", ''), 'yyyyMMdd' )) AS __time,  \"req.ci\",  \"req.co\",  \"req.cse\",  \"req.ctr\",  \"req.el\",  \"req.il\",  \"req.ilt\",  \"req.im\",  \"req.ip\",  \"req.ori\",  \"req.prx\",  \"req.ref\",  \"req.rl\",  \"req.rm\",  \"req.tm\",  \"req.ua\",  \"req.url\",  \"app\",  \"ignore\",  \"os\",  \"vid\",  \"ip\",  \"ua\",  \"cid\",  \"cna\",  \"day\",  \"time\",  \"dow\",  \"geoip\",  \"agent\",  \"code\",  \"source\",  \"dup\",  \"prod\",  \"p\" FROM source PARTITIONED BY DAY",
    "SEARCH TEXT": "INSERT INTO \"%s %s\" WITH source AS (SELECT * FROM TABLE(       EXTERN('{\"type\":\"local\",\"baseDir\":\"%s\",\"filter\":\"%s\"}','{\"type\":\"json\",\"flattenSpec\":{\"fields\":[{\"name\":\"in.f\",\"type\":\"path\",\"expr\":\"$.in.f\"},{\"name\":\"in.insid\",\"type\":\"path\",\"expr\":\"$.in.insid\"},{\"name\":\"in.intxt\",\"type\":\"path\",\"expr\":\"$.in.intxt\"},{\"name\":\"in.npage\",\"type\":\"path\",\"expr\":\"$.in.npage\"},{\"name\":\"in.nsugs\",\"type\":\"path\",\"expr\":\"$.in.nsugs\"},{\"name\":\"in.psize\",\"type\":\"path\",\"expr\":\"$.in.psize\"},{\"name\":\"in.reorder\",\"type\":\"path\",\"expr\":\"$.in.reorder\"},{\"name\":\"in.search_type\",\"type\":\"path\",\"expr\":\"$.in.search_type\"},{\"name\":\"req.ci\",\"type\":\"path\",\"expr\":\"$.req.ci\"},{\"name\":\"req.co\",\"type\":\"path\",\"expr\":\"$.req.co\"},{\"name\":\"req.cse\",\"type\":\"path\",\"expr\":\"$.req.cse\"},{\"name\":\"req.ctr\",\"type\":\"path\",\"expr\":\"$.req.ctr\"},{\"name\":\"req.el\",\"type\":\"path\",\"expr\":\"$.req.el\"},{\"name\":\"req.il\",\"type\":\"path\",\"expr\":\"$.req.il\"},{\"name\":\"req.ilt\",\"type\":\"path\",\"expr\":\"$.req.ilt\"},{\"name\":\"req.im\",\"type\":\"path\",\"expr\":\"$.req.im\"},{\"name\":\"req.ip\",\"type\":\"path\",\"expr\":\"$.req.ip\"},{\"name\":\"req.ori\",\"type\":\"path\",\"expr\":\"$.req.ori\"},{\"name\":\"req.prx\",\"type\":\"path\",\"expr\":\"$.req.prx\"},{\"name\":\"req.ref\",\"type\":\"path\",\"expr\":\"$.req.ref\"},{\"name\":\"req.rl\",\"type\":\"path\",\"expr\":\"$.req.rl\"},{\"name\":\"req.rm\",\"type\":\"path\",\"expr\":\"$.req.rm\"},{\"name\":\"req.tm\",\"type\":\"path\",\"expr\":\"$.req.tm\"},{\"name\":\"req.ua\",\"type\":\"path\",\"expr\":\"$.req.ua\"},{\"name\":\"req.url\",\"type\":\"path\",\"expr\":\"$.req.url\"},{\"name\":\"res.banners\",\"type\":\"path\",\"expr\":\"$.res.banners\"},{\"name\":\"res.f\",\"type\":\"path\",\"expr\":\"$.res.f\"},{\"name\":\"res.hits\",\"type\":\"path\",\"expr\":\"$.res.hits\"},{\"name\":\"res.npage\",\"type\":\"path\",\"expr\":\"$.res.npage\"},{\"name\":\"res.npages\",\"type\":\"path\",\"expr\":\"$.res.npages\"},{\"name\":\"res.nrelevants\",\"type\":\"path\",\"expr\":\"$.res.nrelevants\"},{\"name\":\"res.nretrieved\",\"type\":\"path\",\"expr\":\"$.res.nretrieved\"},{\"name\":\"res.proms\",\"type\":\"path\",\"expr\":\"$.res.proms\"},{\"name\":\"res.psize\",\"type\":\"path\",\"expr\":\"$.res.psize\"},{\"name\":\"res.qnotfound\",\"type\":\"path\",\"expr\":\"$.res.qnotfound\"},{\"name\":\"res.qtext\",\"type\":\"path\",\"expr\":\"$.res.qtext\"},{\"name\":\"res.search_id\",\"type\":\"path\",\"expr\":\"$.res.search_id\"},{\"name\":\"sug.nsugs\",\"type\":\"path\",\"expr\":\"$.sug.nsugs\"}]}}',    '[{\"name\":\"in.f\",\"type\":\"string\"},{\"name\":\"in.insid\",\"type\":\"string\"},{\"name\":\"in.intxt\",\"type\":\"string\"},{\"name\":\"in.npage\",\"type\":\"string\"},{\"name\":\"in.nsugs\",\"type\":\"string\"},{\"name\":\"in.psize\",\"type\":\"string\"},{\"name\":\"in.reorder\",\"type\":\"string\"},{\"name\":\"in.search_type\",\"type\":\"string\"},{\"name\":\"req.ci\",\"type\":\"string\"},{\"name\":\"req.co\",\"type\":\"string\"},{\"name\":\"req.cse\",\"type\":\"string\"},{\"name\":\"req.ctr\",\"type\":\"string\"},{\"name\":\"req.el\",\"type\":\"string\"},{\"name\":\"req.il\",\"type\":\"string\"},{\"name\":\"req.ilt\",\"type\":\"string\"},{\"name\":\"req.im\",\"type\":\"string\"},{\"name\":\"req.ip\",\"type\":\"string\"},{\"name\":\"req.ori\",\"type\":\"string\"},{\"name\":\"req.prx\",\"type\":\"string\"},{\"name\":\"req.ref\",\"type\":\"string\"},{\"name\":\"req.rl\",\"type\":\"string\"},{\"name\":\"req.rm\",\"type\":\"string\"},{\"name\":\"req.tm\",\"type\":\"string\"},{\"name\":\"req.ua\",\"type\":\"string\"},{\"name\":\"req.url\",\"type\":\"string\"},{\"name\":\"res.banners\",\"type\":\"string\"},{\"name\":\"res.f\",\"type\":\"string\"},{\"name\":\"res.hits\",\"type\":\"string\"},{\"name\":\"res.npage\",\"type\":\"string\"},{\"name\":\"res.npages\",\"type\":\"string\"},{\"name\":\"res.nrelevants\",\"type\":\"string\"},{\"name\":\"res.nretrieved\",\"type\":\"string\"},{\"name\":\"res.proms\",\"type\":\"string\"},{\"name\":\"res.psize\",\"type\":\"string\"},{\"name\":\"res.qnotfound\",\"type\":\"string\"},{\"name\":\"res.qtext\",\"type\":\"string\"},{\"name\":\"res.search_id\",\"type\":\"string\"},{\"name\":\"sug.nsugs\",\"type\":\"string\"},{\"name\":\"app\",\"type\":\"long\"},{\"name\":\"ignore\",\"type\":\"long\"},{\"name\":\"os\",\"type\":\"string\"},{\"name\":\"vid\",\"type\":\"string\"},{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"ua\",\"type\":\"string\"},{\"name\":\"cid\",\"type\":\"string\"},{\"name\":\"cna\",\"type\":\"string\"},{\"name\":\"day\",\"type\":\"long\"},{\"name\":\"time\",\"type\":\"long\"},{\"name\":\"dow\",\"type\":\"string\"},{\"name\":\"geoip\",\"type\":\"string\"},{\"name\":\"agent\",\"type\":\"string\"},{\"name\":\"imob\",\"type\":\"string\"},{\"name\":\"isug\",\"type\":\"string\"},{\"name\":\"qtype\",\"type\":\"string\"},{\"name\":\"stype\",\"type\":\"string\"},{\"name\":\"query\",\"type\":\"string\"},{\"name\":\"zero\",\"type\":\"long\"},{\"name\":\"qfinal\",\"type\":\"long\"},{\"name\":\"image\",\"type\":\"string\"},{\"name\":\"sketch\",\"type\":\"string\"},{\"name\":\"exp\",\"type\":\"string\"}]') )) SELECT   COALESCE(CASE WHEN \"day\"> 0 THEN TIME_PARSE(CONCAT(\"day\", ' ',\"time\"), 'yyyyMMdd HHmmssSSS')  ELSE TIME_PARSE(CONCAT(\"day\", ' ',\"time\"), 'yyyyMMdd HHmmssSSS') END, TIME_PARSE(CONCAT(\"day\", ''), 'yyyyMMdd' )) AS __time,   \"in.f\",   \"in.insid\",   \"in.intxt\",   \"in.npage\",   \"in.nsugs\",   \"in.psize\",   \"in.reorder\",   \"in.search_type\",   \"req.ci\",   \"req.co\",   \"req.cse\",   \"req.ctr\",   \"req.el\",   \"req.il\",   \"req.ilt\",   \"req.im\",   \"req.ip\",   \"req.ori\",   \"req.prx\",  \"req.ref\",   \"req.rl\",   \"req.rm\",   \"req.tm\",   \"req.ua\",   \"req.url\",   \"res.banners\",   \"res.f\",   \"res.hits\",   \"res.npage\",   \"res.npages\",   \"res.nrelevants\",   \"res.nretrieved\",   \"res.proms\",   \"res.psize\",   \"res.qnotfound\",   \"res.qtext\",   \"res.search_id\",   \"sug.nsugs\",   \"app\",  \"ignore\",   \"os\",   \"vid\",   \"ip\",   \"ua\",   \"cid\",   \"cna\",   \"day\",   \"time\",   \"dow\",   \"geoip\",   \"agent\",   \"imob\",  \"isug\",   \"qtype\",   \"stype\",   \"query\",   \"zero\",   \"qfinal\",   \"image\",   \"sketch\",   \"exp\" FROM source PARTITIONED BY DAY",
    "VISITORS": "INSERT INTO \"%s %s\" WITH source AS (SELECT * FROM TABLE(  EXTERN(    '{\"type\":\"local\",\"baseDir\":\"%s\",\"filter\":\"%s\"}',    '{\"type\":\"json\",\"flattenSpec\":{\"fields\":[{\"name\":\"stats.click_banners\",\"type\":\"path\",\"expr\":\"$.stats.click_banners\"},{\"name\":\"stats.click_products_ids.total\",\"type\":\"path\",\"expr\":\"$.stats.click_products_ids.total\"},{\"name\":\"stats.click_products_ids.sub\",\"type\":\"path\",\"expr\":\"$.stats.click_products_ids.sub\"},{\"name\":\"stats.click_rules\",\"type\":\"path\",\"expr\":\"$.stats.click_rules\"},{\"name\":\"stats.click_rules.total\",\"type\":\"path\",\"expr\":\"$.stats.click_rules.total\"},{\"name\":\"stats.click_rules.sub\",\"type\":\"path\",\"expr\":\"$.stats.click_rules.sub\"},{\"name\":\"stats.click_types\",\"type\":\"path\",\"expr\":\"$.stats.click_types\"},{\"name\":\"stats.click_types.total\",\"type\":\"path\",\"expr\":\"$.stats.click_types.total\"},{\"name\":\"stats.click_types.sub\",\"type\":\"path\",\"expr\":\"$.stats.click_types.sub\"},{\"name\":\"stats.event_types\",\"type\":\"path\",\"expr\":\"$.stats.event_types\"},{\"name\":\"stats.event_types.total\",\"type\":\"path\",\"expr\":\"$.stats.event_types.total\"},{\"name\":\"stats.event_types.sub\",\"type\":\"path\",\"expr\":\"$.stats.event_types.sub\"},{\"name\":\"stats.geo_ips.total\",\"type\":\"path\",\"expr\":\"$.stats.geo_ips.total\"},{\"name\":\"stats.price_products_ids\",\"type\":\"path\",\"expr\":\"$.stats.price_products_ids\"},{\"name\":\"stats.price_products_ids.total\",\"type\":\"path\",\"expr\":\"$.stats.price_products_ids.total\"},{\"name\":\"stats.price_products_ids.sub\",\"type\":\"path\",\"expr\":\"$.stats.price_products_ids.sub\"},{\"name\":\"stats.query_images\",\"type\":\"path\",\"expr\":\"$.stats.query_images\"},{\"name\":\"stats.query_sketches\",\"type\":\"path\",\"expr\":\"$.stats.query_sketches\"},{\"name\":\"stats.query_sketches.total\",\"type\":\"path\",\"expr\":\"$.stats.query_sketches.total\"},{\"name\":\"stats.query_texts\",\"type\":\"path\",\"expr\":\"$.stats.query_texts\"},{\"name\":\"stats.query_texts.total\",\"type\":\"path\",\"expr\":\"$.stats.query_texts.total\"},{\"name\":\"stats.query_texts.sub\",\"type\":\"path\",\"expr\":\"$.stats.query_texts.sub\"},{\"name\":\"stats.query_types\",\"type\":\"path\",\"expr\":\"$.stats.query_types\"},{\"name\":\"stats.query_types.total\",\"type\":\"path\",\"expr\":\"$.stats.query_types.total\"},{\"name\":\"stats.query_types.sub\",\"type\":\"path\",\"expr\":\"$.stats.query_types.sub\"},{\"name\":\"stats.user_agents.total\",\"type\":\"path\",\"expr\":\"$.stats.user_agents.total\"},{\"name\":\"vid.di\",\"type\":\"path\",\"expr\":\"$.vid.di\"},{\"name\":\"vid.em\",\"type\":\"path\",\"expr\":\"$.vid.em\"},{\"name\":\"vid.os\",\"type\":\"path\",\"expr\":\"$.vid.os\"},{\"name\":\"vid.sc\",\"type\":\"path\",\"expr\":\"$.vid.sc\"},{\"name\":\"vid.tc\",\"type\":\"path\",\"expr\":\"$.vid.tc\"},{\"name\":\"vid.ua\",\"type\":\"path\",\"expr\":\"$.vid.ua\"},{\"name\":\"vid.wi\",\"type\":\"path\",\"expr\":\"$.vid.wi\"}]}}',    '[{\"name\":\"!!!_no_such_column_!!!\",\"type\":\"string\"},{\"name\":\"stats.click_banners\",\"type\":\"string\"},{\"name\":\"stats.click_products_ids.total\",\"type\":\"string\"},{\"name\":\"stats.click_products_ids.sub\",\"type\":\"string\"},{\"name\":\"stats.click_rules\",\"type\":\"string\"},{\"name\":\"stats.click_rules.total\",\"type\":\"string\"},{\"name\":\"stats.click_rules.sub\",\"type\":\"string\"},{\"name\":\"stats.click_types\",\"type\":\"string\"},{\"name\":\"stats.click_types.total\",\"type\":\"string\"},{\"name\":\"stats.click_types.sub\",\"type\":\"string\"},{\"name\":\"stats.event_types\",\"type\":\"string\"},{\"name\":\"stats.event_types.total\",\"type\":\"string\"},{\"name\":\"stats.event_types.sub\",\"type\":\"string\"},{\"name\":\"stats.geo_ips.total\",\"type\":\"string\"},{\"name\":\"stats.price_products_ids\",\"type\":\"string\"},{\"name\":\"stats.price_products_ids.total\",\"type\":\"string\"},{\"name\":\"stats.price_products_ids.sub\",\"type\":\"string\"},{\"name\":\"stats.query_images\",\"type\":\"string\"},{\"name\":\"stats.query_sketches\",\"type\":\"string\"},{\"name\":\"stats.query_sketches.total\",\"type\":\"string\"},{\"name\":\"stats.query_texts\",\"type\":\"string\"},{\"name\":\"stats.query_texts.total\",\"type\":\"string\"},{\"name\":\"stats.query_texts.sub\",\"type\":\"string\"},{\"name\":\"stats.query_types\",\"type\":\"string\"},{\"name\":\"stats.query_types.total\",\"type\":\"string\"},{\"name\":\"stats.query_types.sub\",\"type\":\"string\"},{\"name\":\"stats.user_agents.total\",\"type\":\"string\"},{\"name\":\"vid.di\",\"type\":\"string\"},{\"name\":\"vid.em\",\"type\":\"string\"},{\"name\":\"vid.os\",\"type\":\"string\"},{\"name\":\"vid.sc\",\"type\":\"string\"},{\"name\":\"vid.tc\",\"type\":\"string\"},{\"name\":\"vid.ua\",\"type\":\"string\"},{\"name\":\"vid.wi\",\"type\":\"string\"}]'  ) )) SELECT  COALESCE(CASE WHEN CAST(\"!!!_no_such_column_!!!\" AS BIGINT) > 0 THEN MILLIS_TO_TIMESTAMP(CAST(\"!!!_no_such_column_!!!\" AS BIGINT)) ELSE TIME_PARSE(\"!!!_no_such_column_!!!\") END, TIME_PARSE('%s')) AS __time,  \"stats.click_banners\",  \"stats.click_products_ids.total\",  \"stats.click_products_ids.sub\",  \"stats.click_rules\",  \"stats.click_rules.total\",  \"stats.click_rules.sub\",  \"stats.click_types\",  \"stats.click_types.total\",  \"stats.click_types.sub\",  \"stats.event_types\",  \"stats.event_types.total\",  \"stats.event_types.sub\",  \"stats.geo_ips.total\", \"stats.price_products_ids\",  \"stats.price_products_ids.total\",  \"stats.price_products_ids.sub\",  \"stats.query_images\", \"stats.query_sketches\",  \"stats.query_sketches.total\",  \"stats.query_texts\",  \"stats.query_texts.total\",  \"stats.query_texts.sub\", \"stats.query_types\",  \"stats.query_types.total\",  \"stats.query_types.sub\",  \"stats.user_agents.total\",  \"vid.di\",  \"vid.em\",  \"vid.os\",  \"vid.sc\", \"vid.tc\",  \"vid.ua\",  \"vid.wi\" FROM source PARTITIONED BY DAY",
    "SEARCH IMAGE": "INSERT INTO \"%s %s\" WITH source AS (SELECT * FROM TABLE(       EXTERN(         '{\"type\":\"local\",\"baseDir\":\"%s\",\"filter\":\"%s\"}',         '{\"type\":\"json\",\"flattenSpec\":{\"fields\":[{\"name\":\"image.dtype\",\"type\":\"path\",\"expr\":\"$.image.dtype\"},{\"name\":\"image.etype\",\"type\":\"path\",\"expr\":\"$.image.etype\"},{\"name\":\"image.qdetrank\",\"type\":\"path\",\"expr\":\"$.image.qdetrank\"},{\"name\":\"image.qregion.h\",\"type\":\"path\",\"expr\":\"$.image.qregion.h\"},{\"name\":\"image.qregion.l\",\"type\":\"path\",\"expr\":\"$.image.qregion.l\"},{\"name\":\"image.qregion.t\",\"type\":\"path\",\"expr\":\"$.image.qregion.t\"},{\"name\":\"image.qregion.w\",\"type\":\"path\",\"expr\":\"$.image.qregion.w\"},{\"name\":\"image.querysize.h\",\"type\":\"path\",\"expr\":\"$.image.querysize.h\"},{\"name\":\"image.querysize.w\",\"type\":\"path\",\"expr\":\"$.image.querysize.w\"},{\"name\":\"image.qurl\",\"type\":\"path\",\"expr\":\"$.image.qurl\"},{\"name\":\"image.thumbsize.h\",\"type\":\"path\",\"expr\":\"$.image.thumbsize.h\"},{\"name\":\"image.thumbsize.w\",\"type\":\"path\",\"expr\":\"$.image.thumbsize.w\"},{\"name\":\"image.upload_id\",\"type\":\"path\",\"expr\":\"$.image.upload_id\"},{\"name\":\"in.f\",\"type\":\"path\",\"expr\":\"$.in.f\"},{\"name\":\"in.insid\",\"type\":\"path\",\"expr\":\"$.in.insid\"},{\"name\":\"in.intxt\",\"type\":\"path\",\"expr\":\"$.in.intxt\"},{\"name\":\"in.npage\",\"type\":\"path\",\"expr\":\"$.in.npage\"},{\"name\":\"in.nsugs\",\"type\":\"path\",\"expr\":\"$.in.nsugs\"},{\"name\":\"in.psize\",\"type\":\"path\",\"expr\":\"$.in.psize\"},{\"name\":\"in.reorder\",\"type\":\"path\",\"expr\":\"$.in.reorder\"},{\"name\":\"in.search_type\",\"type\":\"path\",\"expr\":\"$.in.search_type\"},{\"name\":\"req.ci\",\"type\":\"path\",\"expr\":\"$.req.ci\"},{\"name\":\"req.co\",\"type\":\"path\",\"expr\":\"$.req.co\"},{\"name\":\"req.cse\",\"type\":\"path\",\"expr\":\"$.req.cse\"},{\"name\":\"req.ctr\",\"type\":\"path\",\"expr\":\"$.req.ctr\"},{\"name\":\"req.el\",\"type\":\"path\",\"expr\":\"$.req.el\"},{\"name\":\"req.il\",\"type\":\"path\",\"expr\":\"$.req.il\"},{\"name\":\"req.ilt\",\"type\":\"path\",\"expr\":\"$.req.ilt\"},{\"name\":\"req.im\",\"type\":\"path\",\"expr\":\"$.req.im\"},{\"name\":\"req.ip\",\"type\":\"path\",\"expr\":\"$.req.ip\"},{\"name\":\"req.ori\",\"type\":\"path\",\"expr\":\"$.req.ori\"},{\"name\":\"req.prx\",\"type\":\"path\",\"expr\":\"$.req.prx\"},{\"name\":\"req.ref\",\"type\":\"path\",\"expr\":\"$.req.ref\"},{\"name\":\"req.rl\",\"type\":\"path\",\"expr\":\"$.req.rl\"},{\"name\":\"req.rm\",\"type\":\"path\",\"expr\":\"$.req.rm\"},{\"name\":\"req.tm\",\"type\":\"path\",\"expr\":\"$.req.tm\"},{\"name\":\"req.ua\",\"type\":\"path\",\"expr\":\"$.req.ua\"},{\"name\":\"req.url\",\"type\":\"path\",\"expr\":\"$.req.url\"},{\"name\":\"res.banners\",\"type\":\"path\",\"expr\":\"$.res.banners\"},{\"name\":\"res.f\",\"type\":\"path\",\"expr\":\"$.res.f\"},{\"name\":\"res.npage\",\"type\":\"path\",\"expr\":\"$.res.npage\"},{\"name\":\"res.npages\",\"type\":\"path\",\"expr\":\"$.res.npages\"},{\"name\":\"res.nrelevants\",\"type\":\"path\",\"expr\":\"$.res.nrelevants\"},{\"name\":\"res.nretrieved\",\"type\":\"path\",\"expr\":\"$.res.nretrieved\"},{\"name\":\"res.proms\",\"type\":\"path\",\"expr\":\"$.res.proms\"},{\"name\":\"res.psize\",\"type\":\"path\",\"expr\":\"$.res.psize\"},{\"name\":\"res.qnotfound\",\"type\":\"path\",\"expr\":\"$.res.qnotfound\"},{\"name\":\"res.qtext\",\"type\":\"path\",\"expr\":\"$.res.qtext\"},{\"name\":\"res.search_id\",\"type\":\"path\",\"expr\":\"$.res.search_id\"},{\"name\":\"sug.nsugs\",\"type\":\"path\",\"expr\":\"$.sug.nsugs\"}]}}',         '[{\"name\":\"image.dtype\",\"type\":\"string\"},{\"name\":\"image.etype\",\"type\":\"string\"},{\"name\":\"image.qdetrank\",\"type\":\"string\"},{\"name\":\"image.qregion.h\",\"type\":\"string\"},{\"name\":\"image.qregion.l\",\"type\":\"string\"},{\"name\":\"image.qregion.t\",\"type\":\"string\"},{\"name\":\"image.qregion.w\",\"type\":\"string\"},{\"name\":\"image.querysize.h\",\"type\":\"string\"},{\"name\":\"image.querysize.w\",\"type\":\"string\"},{\"name\":\"image.qurl\",\"type\":\"string\"},{\"name\":\"image.thumbsize.h\",\"type\":\"string\"},{\"name\":\"image.thumbsize.w\",\"type\":\"string\"},{\"name\":\"image.upload_id\",\"type\":\"string\"},{\"name\":\"in.f\",\"type\":\"string\"},{\"name\":\"in.insid\",\"type\":\"string\"},{\"name\":\"in.intxt\",\"type\":\"string\"},{\"name\":\"in.npage\",\"type\":\"string\"},{\"name\":\"in.nsugs\",\"type\":\"string\"},{\"name\":\"in.psize\",\"type\":\"string\"},{\"name\":\"in.reorder\",\"type\":\"string\"},{\"name\":\"in.search_type\",\"type\":\"string\"},{\"name\":\"req.ci\",\"type\":\"string\"},{\"name\":\"req.co\",\"type\":\"string\"},{\"name\":\"req.cse\",\"type\":\"string\"},{\"name\":\"req.ctr\",\"type\":\"string\"},{\"name\":\"req.el\",\"type\":\"string\"},{\"name\":\"req.il\",\"type\":\"string\"},{\"name\":\"req.ilt\",\"type\":\"string\"},{\"name\":\"req.im\",\"type\":\"string\"},{\"name\":\"req.ip\",\"type\":\"string\"},{\"name\":\"req.ori\",\"type\":\"string\"},{\"name\":\"req.prx\",\"type\":\"string\"},{\"name\":\"req.ref\",\"type\":\"string\"},{\"name\":\"req.rl\",\"type\":\"string\"},{\"name\":\"req.rm\",\"type\":\"string\"},{\"name\":\"req.tm\",\"type\":\"string\"},{\"name\":\"req.ua\",\"type\":\"string\"},{\"name\":\"req.url\",\"type\":\"string\"},{\"name\":\"res.banners\",\"type\":\"string\"},{\"name\":\"res.f\",\"type\":\"string\"},{\"name\":\"res.npage\",\"type\":\"string\"},{\"name\":\"res.npages\",\"type\":\"string\"},{\"name\":\"res.nrelevants\",\"type\":\"string\"},{\"name\":\"res.nretrieved\",\"type\":\"string\"},{\"name\":\"res.proms\",\"type\":\"string\"},{\"name\":\"res.psize\",\"type\":\"string\"},{\"name\":\"res.qnotfound\",\"type\":\"string\"},{\"name\":\"res.qtext\",\"type\":\"string\"},{\"name\":\"res.search_id\",\"type\":\"string\"},{\"name\":\"sug.nsugs\",\"type\":\"string\"},{\"name\":\"app\",\"type\":\"long\"},{\"name\":\"ignore\",\"type\":\"long\"},{\"name\":\"os\",\"type\":\"string\"},{\"name\":\"vid\",\"type\":\"string\"},{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"ua\",\"type\":\"string\"},{\"name\":\"cid\",\"type\":\"string\"},{\"name\":\"cna\",\"type\":\"string\"},{\"name\":\"day\",\"type\":\"long\"},{\"name\":\"time\",\"type\":\"long\"},{\"name\":\"dow\",\"type\":\"string\"},{\"name\":\"geoip\",\"type\":\"string\"},{\"name\":\"agent\",\"type\":\"string\"},{\"name\":\"imob\",\"type\":\"string\"},{\"name\":\"isug\",\"type\":\"string\"},{\"name\":\"qtype\",\"type\":\"string\"},{\"name\":\"stype\",\"type\":\"string\"},{\"name\":\"query\",\"type\":\"string\"},{\"name\":\"zero\",\"type\":\"long\"},{\"name\":\"qfinal\",\"type\":\"long\"},{\"name\":\"sketch\",\"type\":\"string\"},{\"name\":\"exp\",\"type\":\"string\"}]'      )     ))    SELECT       COALESCE(CASE WHEN \"day\"> 0 THEN TIME_PARSE(CONCAT(\"day\", ' ',\"time\"), 'yyyyMMdd HHmmssSSS')  ELSE TIME_PARSE(CONCAT(\"day\", ' ',\"time\"), 'yyyyMMdd HHmmssSSS') END, TIME_PARSE(CONCAT(\"day\", ''), 'yyyyMMdd' )) AS __time,      \"image.dtype\",       \"image.etype\",       \"image.qdetrank\",       \"image.qregion.h\",       \"image.qregion.l\",       \"image.qregion.t\",       \"image.qregion.w\",       \"image.querysize.h\",       \"image.querysize.w\",       \"image.qurl\",       \"image.thumbsize.h\",       \"image.thumbsize.w\",       \"image.upload_id\",       \"in.f\",       \"in.insid\",       \"in.intxt\",       \"in.npage\",       \"in.nsugs\",       \"in.psize\",      \"in.reorder\",       \"in.search_type\",      \"req.ci\",       \"req.co\",       \"req.cse\",       \"req.ctr\",       \"req.el\",       \"req.il\",       \"req.ilt\",       \"req.im\",       \"req.ip\",       \"req.ori\",       \"req.prx\",       \"req.ref\",       \"req.rl\",       \"req.rm\",      \"req.tm\",      \"req.ua\",       \"req.url\",      \"res.banners\",       \"res.f\",       \"res.npage\",       \"res.npages\",       \"res.nrelevants\",       \"res.nretrieved\",     \"res.proms\",       \"res.psize\",       \"res.qnotfound\",       \"res.qtext\",     \"res.search_id\",      \"sug.nsugs\",       \"app\",       \"ignore\",       \"os\",       \"vid\",     \"ip\",     \"ua\",       \"cid\",       \"cna\",       \"day\",       \"time\",       \"dow\",       \"geoip\",       \"agent\",       \"imob\",       \"isug\",       \"qtype\",       \"stype\",       \"query\",       \"zero\",       \"qfinal\",       \"sketch\",       \"exp\"     FROM source     PARTITIONED BY DAY",
    "SEARCH SKETCH":  "INSERT INTO \"%s %s\" WITH source AS (SELECT * FROM TABLE(  EXTERN(    '{\"type\":\"local\",\"baseDir\":\"%s\",\"filter\":\"%s\"}',    '{\"type\":\"json\",\"flattenSpec\":{\"fields\":[{\"name\":\"in.f\",\"type\":\"path\",\"expr\":\"$.in.f\"},{\"name\":\"in.insid\",\"type\":\"path\",\"expr\":\"$.in.insid\"},{\"name\":\"in.intxt\",\"type\":\"path\",\"expr\":\"$.in.intxt\"},{\"name\":\"in.npage\",\"type\":\"path\",\"expr\":\"$.in.npage\"},{\"name\":\"in.nsugs\",\"type\":\"path\",\"expr\":\"$.in.nsugs\"},{\"name\":\"in.psize\",\"type\":\"path\",\"expr\":\"$.in.psize\"},{\"name\":\"in.reorder\",\"type\":\"path\",\"expr\":\"$.in.reorder\"},{\"name\":\"in.search_type\",\"type\":\"path\",\"expr\":\"$.in.search_type\"},{\"name\":\"req.ci\",\"type\":\"path\",\"expr\":\"$.req.ci\"},{\"name\":\"req.co\",\"type\":\"path\",\"expr\":\"$.req.co\"},{\"name\":\"req.cse\",\"type\":\"path\",\"expr\":\"$.req.cse\"},{\"name\":\"req.ctr\",\"type\":\"path\",\"expr\":\"$.req.ctr\"},{\"name\":\"req.el\",\"type\":\"path\",\"expr\":\"$.req.el\"},{\"name\":\"req.il\",\"type\":\"path\",\"expr\":\"$.req.il\"},{\"name\":\"req.ilt\",\"type\":\"path\",\"expr\":\"$.req.ilt\"},{\"name\":\"req.im\",\"type\":\"path\",\"expr\":\"$.req.im\"},{\"name\":\"req.ip\",\"type\":\"path\",\"expr\":\"$.req.ip\"},{\"name\":\"req.ori\",\"type\":\"path\",\"expr\":\"$.req.ori\"},{\"name\":\"req.prx\",\"type\":\"path\",\"expr\":\"$.req.prx\"},{\"name\":\"req.ref\",\"type\":\"path\",\"expr\":\"$.req.ref\"},{\"name\":\"req.rl\",\"type\":\"path\",\"expr\":\"$.req.rl\"},{\"name\":\"req.rm\",\"type\":\"path\",\"expr\":\"$.req.rm\"},{\"name\":\"req.tm\",\"type\":\"path\",\"expr\":\"$.req.tm\"},{\"name\":\"req.ua\",\"type\":\"path\",\"expr\":\"$.req.ua\"},{\"name\":\"req.url\",\"type\":\"path\",\"expr\":\"$.req.url\"},{\"name\":\"res.banners\",\"type\":\"path\",\"expr\":\"$.res.banners\"},{\"name\":\"res.f\",\"type\":\"path\",\"expr\":\"$.res.f\"},{\"name\":\"res.npage\",\"type\":\"path\",\"expr\":\"$.res.npage\"},{\"name\":\"res.npages\",\"type\":\"path\",\"expr\":\"$.res.npages\"},{\"name\":\"res.nrelevants\",\"type\":\"path\",\"expr\":\"$.res.nrelevants\"},{\"name\":\"res.nretrieved\",\"type\":\"path\",\"expr\":\"$.res.nretrieved\"},{\"name\":\"res.proms\",\"type\":\"path\",\"expr\":\"$.res.proms\"},{\"name\":\"res.psize\",\"type\":\"path\",\"expr\":\"$.res.psize\"},{\"name\":\"res.qnotfound\",\"type\":\"path\",\"expr\":\"$.res.qnotfound\"},{\"name\":\"res.qtext\",\"type\":\"path\",\"expr\":\"$.res.qtext\"},{\"name\":\"res.search_id\",\"type\":\"path\",\"expr\":\"$.res.search_id\"},{\"name\":\"sketch.dets\",\"type\":\"path\",\"expr\":\"$.sketch.dets\"},{\"name\":\"sketch.dtype\",\"type\":\"path\",\"expr\":\"$.sketch.dtype\"},{\"name\":\"sketch.etype\",\"type\":\"path\",\"expr\":\"$.sketch.etype\"},{\"name\":\"sketch.qdetrank\",\"type\":\"path\",\"expr\":\"$.sketch.qdetrank\"},{\"name\":\"sketch.qregion\",\"type\":\"path\",\"expr\":\"$.sketch.qregion\"},{\"name\":\"sketch.querysize.h\",\"type\":\"path\",\"expr\":\"$.sketch.querysize.h\"},{\"name\":\"sketch.querysize.w\",\"type\":\"path\",\"expr\":\"$.sketch.querysize.w\"},{\"name\":\"sketch.qurl\",\"type\":\"path\",\"expr\":\"$.sketch.qurl\"},{\"name\":\"sketch.thumbsize.h\",\"type\":\"path\",\"expr\":\"$.sketch.thumbsize.h\"},{\"name\":\"sketch.thumbsize.w\",\"type\":\"path\",\"expr\":\"$.sketch.thumbsize.w\"},{\"name\":\"sketch.upload_id\",\"type\":\"path\",\"expr\":\"$.sketch.upload_id\"},{\"name\":\"sug.nsugs\",\"type\":\"path\",\"expr\":\"$.sug.nsugs\"}]}}',    '[{\"name\":\"in.f\",\"type\":\"string\"},{\"name\":\"in.insid\",\"type\":\"string\"},{\"name\":\"in.intxt\",\"type\":\"string\"},{\"name\":\"in.npage\",\"type\":\"string\"},{\"name\":\"in.nsugs\",\"type\":\"string\"},{\"name\":\"in.psize\",\"type\":\"string\"},{\"name\":\"in.reorder\",\"type\":\"string\"},{\"name\":\"in.search_type\",\"type\":\"string\"},{\"name\":\"req.ci\",\"type\":\"string\"},{\"name\":\"req.co\",\"type\":\"string\"},{\"name\":\"req.cse\",\"type\":\"string\"},{\"name\":\"req.ctr\",\"type\":\"string\"},{\"name\":\"req.el\",\"type\":\"string\"},{\"name\":\"req.il\",\"type\":\"string\"},{\"name\":\"req.ilt\",\"type\":\"string\"},{\"name\":\"req.im\",\"type\":\"string\"},{\"name\":\"req.ip\",\"type\":\"string\"},{\"name\":\"req.ori\",\"type\":\"string\"},{\"name\":\"req.prx\",\"type\":\"string\"},{\"name\":\"req.ref\",\"type\":\"string\"},{\"name\":\"req.rl\",\"type\":\"string\"},{\"name\":\"req.rm\",\"type\":\"string\"},{\"name\":\"req.tm\",\"type\":\"string\"},{\"name\":\"req.ua\",\"type\":\"string\"},{\"name\":\"req.url\",\"type\":\"string\"},{\"name\":\"res.banners\",\"type\":\"string\"},{\"name\":\"res.f\",\"type\":\"string\"},{\"name\":\"res.npage\",\"type\":\"string\"},{\"name\":\"res.npages\",\"type\":\"string\"},{\"name\":\"res.nrelevants\",\"type\":\"string\"},{\"name\":\"res.nretrieved\",\"type\":\"string\"},{\"name\":\"res.proms\",\"type\":\"string\"},{\"name\":\"res.psize\",\"type\":\"string\"},{\"name\":\"res.qnotfound\",\"type\":\"string\"},{\"name\":\"res.qtext\",\"type\":\"string\"},{\"name\":\"res.search_id\",\"type\":\"string\"},{\"name\":\"sketch.dets\",\"type\":\"string\"},{\"name\":\"sketch.dtype\",\"type\":\"string\"},{\"name\":\"sketch.etype\",\"type\":\"string\"},{\"name\":\"sketch.qdetrank\",\"type\":\"string\"},{\"name\":\"sketch.qregion\",\"type\":\"string\"},{\"name\":\"sketch.querysize.h\",\"type\":\"string\"},{\"name\":\"sketch.querysize.w\",\"type\":\"string\"},{\"name\":\"sketch.qurl\",\"type\":\"string\"},{\"name\":\"sketch.thumbsize.h\",\"type\":\"string\"},{\"name\":\"sketch.thumbsize.w\",\"type\":\"string\"},{\"name\":\"sketch.upload_id\",\"type\":\"string\"},{\"name\":\"sug.nsugs\",\"type\":\"string\"},{\"name\":\"app\",\"type\":\"long\"},{\"name\":\"ignore\",\"type\":\"long\"},{\"name\":\"os\",\"type\":\"string\"},{\"name\":\"vid\",\"type\":\"string\"},{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"ua\",\"type\":\"string\"},{\"name\":\"cid\",\"type\":\"string\"},{\"name\":\"cna\",\"type\":\"string\"},{\"name\":\"day\",\"type\":\"long\"},{\"name\":\"time\",\"type\":\"long\"},{\"name\":\"dow\",\"type\":\"string\"},{\"name\":\"geoip\",\"type\":\"string\"},{\"name\":\"agent\",\"type\":\"string\"},{\"name\":\"imob\",\"type\":\"string\"},{\"name\":\"isug\",\"type\":\"string\"},{\"name\":\"qtype\",\"type\":\"string\"},{\"name\":\"stype\",\"type\":\"string\"},{\"name\":\"query\",\"type\":\"string\"},{\"name\":\"zero\",\"type\":\"long\"},{\"name\":\"qfinal\",\"type\":\"long\"},{\"name\":\"image\",\"type\":\"string\"},{\"name\":\"exp\",\"type\":\"string\"}]'  ))) SELECT    COALESCE(CASE WHEN \"day\"> 0 THEN TIME_PARSE(CONCAT(\"day\", ' ',\"time\"), 'yyyyMMdd HHmmssSSS')  ELSE TIME_PARSE(CONCAT(\"day\", ' ',\"time\"), 'yyyyMMdd HHmmssSSS') END, TIME_PARSE(CONCAT(\"day\", ''), 'yyyyMMdd' )) AS __time,  \"in.f\",  \"in.insid\",  \"in.intxt\",  \"in.npage\",  \"in.nsugs\",  \"in.psize\",  \"in.reorder\",  \"in.search_type\",  \"req.ci\",  \"req.co\",  \"req.cse\",  \"req.ctr\",  \"req.el\",  \"req.il\",  \"req.ilt\",  \"req.im\",  \"req.ip\",  \"req.ori\",  \"req.prx\",  \"req.ref\",  \"req.rl\",  \"req.rm\",  \"req.tm\",  \"req.ua\",  \"req.url\",  \"res.banners\",  \"res.f\",  \"res.npage\",  \"res.npages\",  \"res.nrelevants\",  \"res.nretrieved\",  \"res.proms\",  \"res.psize\",  \"res.qnotfound\",  \"res.qtext\",  \"res.search_id\",  \"sketch.dets\",  \"sketch.dtype\",  \"sketch.etype\",  \"sketch.qdetrank\",  \"sketch.qregion\",  \"sketch.querysize.h\",  \"sketch.querysize.w\",  \"sketch.qurl\",  \"sketch.thumbsize.h\",  \"sketch.thumbsize.w\",  \"sketch.upload_id\",  \"sug.nsugs\",  \"app\",  \"ignore\",  \"os\",  \"vid\",  \"ip\",  \"ua\",  \"cid\",  \"cna\",  \"day\",  \"time\",  \"dow\",  \"geoip\",  \"agent\",  \"imob\", \"isug\",  \"qtype\",  \"stype\",  \"query\",  \"zero\",  \"qfinal\",  \"image\",  \"exp\" FROM source PARTITIONED BY DAY",
    "PRODUCTS" : "INSERT INTO \"%s %s\" WITH source AS (SELECT * FROM TABLE(  EXTERN(    '{\"type\":\"local\",\"baseDir\":\"%s\",\"filter\":\"%s\"}',    '{\"type\":\"json\",\"flattenSpec\":{\"fields\":[{\"name\":\"stats.nadd\",\"type\":\"path\",\"expr\":\"$.stats.nadd\"},{\"name\":\"stats.nconv\",\"type\":\"path\",\"expr\":\"$.stats.nconv\"},{\"name\":\"stats.nview\",\"type\":\"path\",\"expr\":\"$.stats.nview\"},{\"name\":\"stats.padd\",\"type\":\"path\",\"expr\":\"$.stats.padd\"},{\"name\":\"stats.pconv\",\"type\":\"path\",\"expr\":\"$.stats.pconv\"},{\"name\":\"stats.vadd\",\"type\":\"path\",\"expr\":\"$.stats.vadd\"},{\"name\":\"stats.vclick\",\"type\":\"path\",\"expr\":\"$.stats.vclick\"},{\"name\":\"stats.vclickadd\",\"type\":\"path\",\"expr\":\"$.stats.vclickadd\"},{\"name\":\"stats.vclickconv\",\"type\":\"path\",\"expr\":\"$.stats.vclickconv\"},{\"name\":\"stats.vclickprom\",\"type\":\"path\",\"expr\":\"$.stats.vclickprom\"},{\"name\":\"stats.vconv\",\"type\":\"path\",\"expr\":\"$.stats.vconv\"},{\"name\":\"stats.vhit\",\"type\":\"path\",\"expr\":\"$.stats.vhit\"},{\"name\":\"stats.vhitadd\",\"type\":\"path\",\"expr\":\"$.stats.vhitadd\"},{\"name\":\"stats.vhitconv\",\"type\":\"path\",\"expr\":\"$.stats.vhitconv\"},{\"name\":\"stats.vhitprom\",\"type\":\"path\",\"expr\":\"$.stats.vhitprom\"},{\"name\":\"stats.vview\",\"type\":\"path\",\"expr\":\"$.stats.vview\"}]}}',    '[{\"name\":\"!!!_no_such_column_!!!\",\"type\":\"string\"},{\"name\":\"stats.nadd\",\"type\":\"string\"},{\"name\":\"stats.nconv\",\"type\":\"string\"},{\"name\":\"stats.nview\",\"type\":\"string\"},{\"name\":\"stats.padd\",\"type\":\"string\"},{\"name\":\"stats.pconv\",\"type\":\"string\"},{\"name\":\"stats.vadd\",\"type\":\"string\"},{\"name\":\"stats.vclick\",\"type\":\"string\"},{\"name\":\"stats.vclickadd\",\"type\":\"string\"},{\"name\":\"stats.vclickconv\",\"type\":\"string\"},{\"name\":\"stats.vclickprom\",\"type\":\"string\"},{\"name\":\"stats.vconv\",\"type\":\"string\"},{\"name\":\"stats.vhit\",\"type\":\"string\"},{\"name\":\"stats.vhitadd\",\"type\":\"string\"},{\"name\":\"stats.vhitconv\",\"type\":\"string\"},{\"name\":\"stats.vhitprom\",\"type\":\"string\"},{\"name\":\"stats.vview\",\"type\":\"string\"},{\"name\":\"variant_id\",\"type\":\"string\"},{\"name\":\"name\",\"type\":\"string\"},{\"name\":\"url\",\"type\":\"string\"},{\"name\":\"image\",\"type\":\"string\"},{\"name\":\"price\",\"type\":\"string\"},{\"name\":\"category\",\"type\":\"string\"},{\"name\":\"brand\",\"type\":\"string\"},{\"name\":\"sku\",\"type\":\"string\"},{\"name\":\"parent_id\",\"type\":\"string\"},{\"name\":\"active\",\"type\":\"long\"},{\"name\":\"old\",\"type\":\"long\"},{\"name\":\"unknown\",\"type\":\"long\"},{\"name\":\"atts\",\"type\":\"COMPLEX<json>\"}]'  ) )) SELECT  COALESCE(CASE WHEN CAST(\"!!!_no_such_column_!!!\" AS BIGINT) > 0 THEN MILLIS_TO_TIMESTAMP(CAST(\"!!!_no_such_column_!!!\" AS BIGINT)) ELSE TIME_PARSE(\"!!!_no_such_column_!!!\") END, TIME_PARSE('%s')) AS __time,  \"stats.nadd\",  \"stats.nconv\",  \"stats.nview\",  \"stats.padd\",  \"stats.pconv\",  \"stats.vadd\",  \"stats.vclick\",  \"stats.vclickadd\",  \"stats.vclickconv\",  \"stats.vclickprom\",  \"stats.vconv\",  \"stats.vhit\",  \"stats.vhitadd\",  \"stats.vhitconv\",  \"stats.vhitprom\",  \"stats.vview\",  \"variant_id\",  \"name\",  \"url\",  \"image\",  \"price\",  \"category\",  \"brand\",  \"sku\",  \"parent_id\",  \"active\",  \"old\",  \"unknown\",  \"atts\" FROM source PARTITIONED BY MONTH",
    "EVENT PRODS": "INSERT INTO \"%s %s\" WITH source AS (SELECT * FROM TABLE(  EXTERN(    '{\"type\":\"local\",\"baseDir\":\"%s\",\"filter\":\"%s\"}',   '{\"type\":\"json\",\"flattenSpec\":{\"fields\":[{\"name\":\"prod.p\",\"type\":\"path\",\"expr\":\"$.prod.p\"},{\"name\":\"prod.pr\",\"type\":\"path\",\"expr\":\"$.prod.pr\"},{\"name\":\"prod.q\",\"type\":\"path\",\"expr\":\"$.prod.q\"},{\"name\":\"prod.qr\",\"type\":\"path\",\"expr\":\"$.prod.qr\"},{\"name\":\"prod.qt\",\"type\":\"path\",\"expr\":\"$.prod.qt\"},{\"name\":\"prod.variant\",\"type\":\"path\",\"expr\":\"$.prod.variant\"},{\"name\":\"prod.wc\",\"type\":\"path\",\"expr\":\"$.prod.wc\"},{\"name\":\"prod.wci\",\"type\":\"path\",\"expr\":\"$.prod.wci\"},{\"name\":\"prod.wcs\",\"type\":\"path\",\"expr\":\"$.prod.wcs\"},{\"name\":\"prod.wh\",\"type\":\"path\",\"expr\":\"$.prod.wh\"},{\"name\":\"req.ci\",\"type\":\"path\",\"expr\":\"$.req.ci\"},{\"name\":\"req.cse\",\"type\":\"path\",\"expr\":\"$.req.cse\"},{\"name\":\"req.ctr\",\"type\":\"path\",\"expr\":\"$.req.ctr\"},{\"name\":\"req.el\",\"type\":\"path\",\"expr\":\"$.req.el\"},{\"name\":\"req.il\",\"type\":\"path\",\"expr\":\"$.req.il\"},{\"name\":\"req.ilt\",\"type\":\"path\",\"expr\":\"$.req.ilt\"},{\"name\":\"req.im\",\"type\":\"path\",\"expr\":\"$.req.im\"},{\"name\":\"req.ip\",\"type\":\"path\",\"expr\":\"$.req.ip\"},{\"name\":\"req.la\",\"type\":\"path\",\"expr\":\"$.req.la\"},{\"name\":\"req.ori\",\"type\":\"path\",\"expr\":\"$.req.ori\"},{\"name\":\"req.prx\",\"type\":\"path\",\"expr\":\"$.req.prx\"},{\"name\":\"req.ref\",\"type\":\"path\",\"expr\":\"$.req.ref\"},{\"name\":\"req.rl\",\"type\":\"path\",\"expr\":\"$.req.rl\"},{\"name\":\"req.rm\",\"type\":\"path\",\"expr\":\"$.req.rm\"},{\"name\":\"req.tm\",\"type\":\"path\",\"expr\":\"$.req.tm\"},{\"name\":\"req.tr\",\"type\":\"path\",\"expr\":\"$.req.tr\"},{\"name\":\"req.ua\",\"type\":\"path\",\"expr\":\"$.req.ua\"},{\"name\":\"req.url\",\"type\":\"path\",\"expr\":\"$.req.url\"}]}}',    '[{\"name\":\"prod.p\",\"type\":\"string\"},{\"name\":\"prod.pr\",\"type\":\"string\"},{\"name\":\"prod.q\",\"type\":\"string\"},{\"name\":\"prod.qr\",\"type\":\"string\"},{\"name\":\"prod.qt\",\"type\":\"string\"},{\"name\":\"prod.variant\",\"type\":\"string\"},{\"name\":\"prod.wc\",\"type\":\"string\"},{\"name\":\"prod.wci\",\"type\":\"string\"},{\"name\":\"prod.wcs\",\"type\":\"string\"},{\"name\":\"prod.wh\",\"type\":\"string\"},{\"name\":\"req.ci\",\"type\":\"string\"},{\"name\":\"req.cse\",\"type\":\"string\"},{\"name\":\"req.ctr\",\"type\":\"string\"},{\"name\":\"req.el\",\"type\":\"string\"},{\"name\":\"req.il\",\"type\":\"string\"},{\"name\":\"req.ilt\",\"type\":\"string\"},{\"name\":\"req.im\",\"type\":\"string\"},{\"name\":\"req.ip\",\"type\":\"string\"},{\"name\":\"req.la\",\"type\":\"string\"},{\"name\":\"req.ori\",\"type\":\"string\"},{\"name\":\"req.prx\",\"type\":\"string\"},{\"name\":\"req.ref\",\"type\":\"string\"},{\"name\":\"req.rl\",\"type\":\"string\"},{\"name\":\"req.rm\",\"type\":\"string\"},{\"name\":\"req.tm\",\"type\":\"string\"},{\"name\":\"req.tr\",\"type\":\"string\"},{\"name\":\"req.ua\",\"type\":\"string\"},{\"name\":\"req.url\",\"type\":\"string\"},{\"name\":\"app\",\"type\":\"long\"},{\"name\":\"os\",\"type\":\"string\"},{\"name\":\"vid\",\"type\":\"string\"},{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"ua\",\"type\":\"string\"},{\"name\":\"cid\",\"type\":\"string\"},{\"name\":\"cna\",\"type\":\"string\"},{\"name\":\"day\",\"type\":\"long\"},{\"name\":\"time\",\"type\":\"long\"},{\"name\":\"dow\",\"type\":\"string\"},{\"name\":\"geoip\",\"type\":\"string\"},{\"name\":\"agent\",\"type\":\"string\"},{\"name\":\"code\",\"type\":\"string\"},{\"name\":\"source\",\"type\":\"string\"}]'  ))) SELECT  COALESCE(CASE WHEN \"day\"> 0 THEN TIME_PARSE(CONCAT(\"day\", ' ',\"time\"), 'yyyyMMdd HHmmssSSS')  ELSE TIME_PARSE(CONCAT(\"day\", ' ',\"time\"), 'yyyyMMdd HHmmssSSS') END, TIME_PARSE(CONCAT(\"day\", ''), 'yyyyMMdd' )) AS __time,  \"prod.p\",  \"prod.pr\",  \"prod.q\",  \"prod.qr\",  \"prod.qt\",  \"prod.variant\",  \"prod.wc\",  \"prod.wci\",  \"prod.wcs\",  \"prod.wh\",  \"req.ci\",  \"req.cse\",  \"req.ctr\",  \"req.el\",  \"req.il\",  \"req.ilt\",  \"req.im\",  \"req.ip\",  \"req.la\",  \"req.ori\",  \"req.prx\",  \"req.ref\",  \"req.rl\",  \"req.rm\",  \"req.tm\",  \"req.tr\",  \"req.ua\",  \"req.url\",  \"app\",  \"os\",  \"vid\",  \"ip\",  \"ua\",  \"cid\",  \"cna\",  \"day\",  \"time\",  \"dow\",  \"geoip\",  \"agent\",  \"code\",  \"source\" FROM source PARTITIONED BY DAY"
}
